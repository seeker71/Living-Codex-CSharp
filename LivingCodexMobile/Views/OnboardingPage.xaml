<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="LivingCodexMobile.Views.OnboardingPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:DataType="viewmodel:OnboardingViewModel"
             xmlns:viewmodel="clr-namespace:LivingCodexMobile.ViewModels"
             xmlns:model="clr-namespace:LivingCodexMobile.Models"
             Title="Welcome to Living Codex">

    <CarouselView x:Name="OnboardingCarousel"
                  ItemsSource="{Binding OnboardingSteps}"
                  CurrentItemChanged="OnCarouselCurrentItemChanged">
        
        <CarouselView.ItemTemplate>
            <DataTemplate x:DataType="model:OnboardingStep">
                <ScrollView>
                    <StackLayout Padding="30" Spacing="30" VerticalOptions="Center">
                        
                        <!-- Step Icon -->
                        <Image Source="{Binding Icon}"
                               HeightRequest="120"
                               HorizontalOptions="Center" />

                        <!-- Step Title -->
                        <Label Text="{Binding Title}"
                               FontSize="28"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"
                               TextColor="#512BD4" />

                        <!-- Step Description -->
                        <Label Text="{Binding Description}"
                               FontSize="16"
                               HorizontalOptions="Center"
                               TextColor="Gray"
                               HorizontalTextAlignment="Center" />

                        <!-- Step Features -->
                        <StackLayout Spacing="15" IsVisible="{Binding Features.Count, Converter={StaticResource StringToBoolConverter}}">
                            <Label Text="Key Features:"
                                   FontSize="18"
                                   FontAttributes="Bold"
                                   HorizontalOptions="Center" />
                            
                            <CollectionView ItemsSource="{Binding Features}">
                                <CollectionView.ItemTemplate>
                                    <DataTemplate x:DataType="x:String">
                                        <Grid Padding="10">
                                            <Label Text="{Binding .}"
                                                   FontSize="14"
                                                   TextColor="DarkGray"
                                                   HorizontalOptions="Center" />
                                        </Grid>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                            </CollectionView>
                        </StackLayout>

                        <!-- Demo Content for News Feed Step -->
                        <StackLayout IsVisible="{Binding IsNewsFeedStep}">
                            <Label Text="Live News Feed Preview:"
                                   FontSize="18"
                                   FontAttributes="Bold"
                                   HorizontalOptions="Center" />
                            
                            <Frame BackgroundColor="White"
                                   CornerRadius="10"
                                   Padding="15"
                                   Margin="0,10,0,0">
                                <StackLayout Spacing="10">
                                    <Label Text="AI Breakthrough in Quantum Computing"
                                           FontSize="16"
                                           FontAttributes="Bold" />
                                    <Label Text="Scientists have made a significant breakthrough..."
                                           FontSize="12"
                                           TextColor="Gray"
                                           MaxLines="2" />
                                    <StackLayout Orientation="Horizontal" Spacing="20">
                                        <Label Text="Resonance: 8.5"
                                               FontSize="12"
                                               TextColor="#512BD4" />
                                        <Label Text="Energy: 7.2"
                                               FontSize="12"
                                               TextColor="#7B1FA2" />
                                    </StackLayout>
                                </StackLayout>
                            </Frame>
                        </StackLayout>

                    </StackLayout>
                </ScrollView>
            </DataTemplate>
        </CarouselView.ItemTemplate>
    </CarouselView>

    <!-- Bottom Navigation -->
    <Grid RowDefinitions="Auto,*" VerticalOptions="End">
        
        <!-- Page Indicators -->
        <StackLayout Grid.Row="0" 
                     Orientation="Horizontal" 
                     HorizontalOptions="Center"
                     Spacing="10"
                     Margin="0,0,0,20">
            <BoxView x:Name="Indicator1" 
                     Color="#512BD4" 
                     WidthRequest="8" 
                     HeightRequest="8" 
                     CornerRadius="4" />
            <BoxView x:Name="Indicator2" 
                     Color="LightGray" 
                     WidthRequest="8" 
                     HeightRequest="8" 
                     CornerRadius="4" />
            <BoxView x:Name="Indicator3" 
                     Color="LightGray" 
                     WidthRequest="8" 
                     HeightRequest="8" 
                     CornerRadius="4" />
            <BoxView x:Name="Indicator4" 
                     Color="LightGray" 
                     WidthRequest="8" 
                     HeightRequest="8" 
                     CornerRadius="4" />
        </StackLayout>

        <!-- Action Buttons -->
        <StackLayout Grid.Row="1" 
                     Orientation="Horizontal" 
                     HorizontalOptions="FillAndExpand"
                     Padding="20,0,20,30"
                     Spacing="10">
            
            <Button Text="Skip"
                    Command="{Binding SkipCommand}"
                    BackgroundColor="Transparent"
                    TextColor="Gray"
                    HorizontalOptions="StartAndExpand" />
            
            <Button Text="{Binding NextButtonText}"
                    Command="{Binding NextCommand}"
                    BackgroundColor="#512BD4"
                    TextColor="White"
                    HorizontalOptions="EndAndExpand"
                    WidthRequest="120" />
        </StackLayout>
    </Grid>

</ContentPage>

